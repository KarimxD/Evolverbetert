<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Evolverbetert</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#main"><span class="hs-identifier hs-var">main</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span class="hs-keyword">import</span><span>           </span><a href="Misc.html"><span class="hs-identifier">Misc</span></a><span>                   </span><span class="hs-special">(</span><a href="Misc.html#maybeCh"><span class="hs-identifier hs-var">maybeCh</span></a><span class="hs-special">,</span><span> </span><a href="Misc.html#moore8"><span class="hs-identifier hs-var">moore8</span></a><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span>           </span><a href="Mutations.html"><span class="hs-identifier">Mutations</span></a><span>              </span><span class="hs-special">(</span><a href="Mutations.html#mutAg"><span class="hs-identifier hs-var">mutAg</span></a><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span>           </span><a href="MyGraphics.html"><span class="hs-identifier">MyGraphics</span></a><span>             </span><span class="hs-special">(</span><a href="MyGraphics.html#showWorld"><span class="hs-identifier hs-var">showWorld</span></a><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span>           </span><a href="MyRandom.html"><span class="hs-identifier">MyRandom</span></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Parameters.html"><span class="hs-identifier">Parameters</span></a><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">P</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span>           </span><a href="World.html"><span class="hs-identifier">World</span></a><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Char8</span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hPutStrLn</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">IORef</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">writeIORef</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromString</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">GLUT</span><span>       </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Help</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">initialize</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mainLoop</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Console</span><span class="hs-operator">.</span><span class="hs-identifier">GetOpt</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Environment</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getArgs</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Handle</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IOMode</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">hClose</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">hFlush</span><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>                                         </span><span class="hs-identifier hs-var">openFile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">stdout</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Fixed</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod'</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">on</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">IArray</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">array</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">assocs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elems</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maximumBy</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">Split</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">splitEvery</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Parallel</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Par</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- |Uses a list of flags to initialize a IORef to a world and a handle for</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- output.</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- Generates an initial agent, populates the world wit it</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- Sets the PRNG</span><span>
</span><a name="line-34"></a><span class="hs-identifier">initialize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Evolverbetert.html#Flag"><span class="hs-identifier hs-type">Flag</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Handle</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><a name="initialize"><a href="Evolverbetert.html#initialize"><span class="hs-identifier">initialize</span></a></a><span> </span><a name="local-6989586621679083871"><a href="#local-6989586621679083871"><span class="hs-identifier">flags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="Evolverbetert.html#WorldSeed"><span class="hs-identifier hs-var">WorldSeed</span></a><span> </span><a name="local-6989586621679083873"><a href="#local-6989586621679083873"><span class="hs-identifier">sWorldSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#WorldSeed"><span class="hs-identifier hs-var">WorldSeed</span></a><span> </span><span class="hs-string">&quot;420&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span> </span><a href="Evolverbetert.html#isWorldSeed"><span class="hs-identifier hs-var">isWorldSeed</span></a><span> </span><a href="#local-6989586621679083871"><span class="hs-identifier hs-var">flags</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>        </span><a href="Evolverbetert.html#AgentSeed"><span class="hs-identifier hs-var">AgentSeed</span></a><span> </span><a name="local-6989586621679083874"><a href="#local-6989586621679083874"><span class="hs-identifier">sAgentSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#AgentSeed"><span class="hs-identifier hs-var">AgentSeed</span></a><span> </span><span class="hs-string">&quot;420&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span> </span><a href="Evolverbetert.html#isAgentSeed"><span class="hs-identifier hs-var">isAgentSeed</span></a><span> </span><a href="#local-6989586621679083871"><span class="hs-identifier hs-var">flags</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>        </span><a href="Evolverbetert.html#OutputFile"><span class="hs-identifier hs-var">OutputFile</span></a><span> </span><a name="local-6989586621679083875"><a href="#local-6989586621679083875"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#OutputFile"><span class="hs-identifier hs-var">OutputFile</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span> </span><a href="Evolverbetert.html#isOutputFile"><span class="hs-identifier hs-var">isOutputFile</span></a><span> </span><a href="#local-6989586621679083871"><span class="hs-identifier hs-var">flags</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>        </span><a name="local-6989586621679083876"><a href="#local-6989586621679083876"><span class="hs-identifier">worldSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679083873"><span class="hs-identifier hs-var">sWorldSeed</span></a><span>
</span><a name="line-40"></a><span>        </span><a name="local-6989586621679083877"><a href="#local-6989586621679083877"><span class="hs-identifier">agentSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679083874"><span class="hs-identifier hs-var">sAgentSeed</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#Help"><span class="hs-identifier hs-var">Help</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679083871"><span class="hs-identifier hs-var">flags</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ioError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">userError</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">usageInfo</span><span> </span><a href="#local-6989586621679083872"><span class="hs-identifier hs-var">header</span></a><span> </span><a href="Evolverbetert.html#options"><span class="hs-identifier hs-var">options</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679084572"><a href="#local-6989586621679084572"><span class="hs-identifier">initialAgent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MyRandom.html#evalRand"><span class="hs-identifier hs-var">evalRand</span></a><span> </span><a href="World.html#randomAgent"><span class="hs-identifier hs-var">randomAgent</span></a><span> </span><span class="hs-special">(</span><a href="MyRandom.html#pureMT"><span class="hs-identifier hs-var">pureMT</span></a><span> </span><a href="#local-6989586621679083877"><span class="hs-identifier hs-var">agentSeed</span></a><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>        </span><a name="local-6989586621679084573"><a href="#local-6989586621679084573"><span class="hs-identifier">initialWorld</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a href="#local-6989586621679084574"><span class="hs-identifier hs-var">startAgents</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-46"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679084574"><a href="#local-6989586621679084574"><span class="hs-identifier">startAgents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">array</span><span> </span><a href="Parameters.html#worldBounds"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">worldBounds</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="Parameters.html#worldCoods"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">worldCoods</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">repeat</span><span> </span><a href="#local-6989586621679084572"><span class="hs-identifier hs-var">initialAgent</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>    </span><a name="local-6989586621679084575"><a href="#local-6989586621679084575"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><a href="#local-6989586621679084573"><span class="hs-identifier hs-var">initialWorld</span></a><span>
</span><a name="line-49"></a><span>    </span><a href="MyRandom.html#setMyStdGen"><span class="hs-identifier hs-var">setMyStdGen</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MyRandom.html#pureMT"><span class="hs-identifier hs-var">pureMT</span></a><span> </span><a href="#local-6989586621679083876"><span class="hs-identifier hs-var">worldSeed</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679084576"><a href="#local-6989586621679084576"><span class="hs-identifier">getHandle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><a href="Evolverbetert.html#isOutputFile"><span class="hs-identifier hs-var">isOutputFile</span></a><span> </span><a href="#local-6989586621679083871"><span class="hs-identifier hs-var">flags</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-54"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">stdout</span><span>
</span><a name="line-55"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#OutputFile"><span class="hs-identifier hs-var">OutputFile</span></a><span> </span><a name="local-6989586621679084646"><a href="#local-6989586621679084646"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">openFile</span><span> </span><a href="#local-6989586621679084646"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-identifier hs-var">ReadWriteMode</span><span>
</span><a name="line-56"></a><span>    </span><a name="local-6989586621679084845"><a href="#local-6989586621679084845"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679084576"><span class="hs-identifier hs-var">getHandle</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">hPutStrLn</span><span> </span><a href="#local-6989586621679084845"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Initial Agent is: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679084572"><span class="hs-identifier hs-var">initialAgent</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679084575"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679084845"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679083872"><a href="#local-6989586621679083872"><span class="hs-identifier">header</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Usage: Evolverbetert [OPTION...]&quot;</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- | Maybe initializes graphical display dependent on 'P.display' in &quot;Parameters&quot;</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- calls 'initialize'</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- starts 'mainLoop'</span><span>
</span><a name="line-64"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><a name="main"><a href="Evolverbetert.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-66"></a><span>    </span><a name="local-6989586621679084846"><a href="#local-6989586621679084846"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getArgs</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679084847"><a href="#local-6989586621679084847"><span class="hs-identifier">flags</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679084848"><a href="#local-6989586621679084848"><span class="hs-identifier">strings</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Evolverbetert.html#compilerOpts"><span class="hs-identifier hs-var">compilerOpts</span></a><span> </span><a href="#local-6989586621679084846"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679084849"><a href="#local-6989586621679084849"><span class="hs-identifier">worldRef</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679084850"><a href="#local-6989586621679084850"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Evolverbetert.html#initialize"><span class="hs-identifier hs-var">initialize</span></a><span> </span><a href="#local-6989586621679084847"><span class="hs-identifier hs-var">flags</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-comment">-- All GLUT related stuff</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><a href="Parameters.html#display"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">display</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-73"></a><span>        </span><span class="hs-identifier hs-var">getArgsAndInitialize</span><span>
</span><a name="line-74"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679085574"><a href="#local-6989586621679085574"><span class="hs-identifier">pixelsPerUnit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-75"></a><span>            </span><a name="local-6989586621679085575"><a href="#local-6989586621679085575"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679085574"><span class="hs-identifier hs-var">pixelsPerUnit</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Parameters.html#width"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">width</span></a><span>
</span><a name="line-76"></a><span>            </span><a name="local-6989586621679085576"><a href="#local-6989586621679085576"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679085574"><span class="hs-identifier hs-var">pixelsPerUnit</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="Parameters.html#height"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">height</span></a><span>
</span><a name="line-77"></a><span>        </span><span class="hs-identifier hs-var">initialDisplayMode</span><span> </span><span class="hs-operator hs-var">$=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">RGBMode</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">DoubleBuffered</span><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span>        </span><span class="hs-identifier hs-var">initialWindowSize</span><span> </span><span class="hs-operator hs-var">$=</span><span> </span><span class="hs-identifier hs-var">Size</span><span> </span><a href="#local-6989586621679085575"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679085576"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-79"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Size</span><span> </span><a name="local-6989586621679086499"><a href="#local-6989586621679086499"><span class="hs-identifier">screenSizeX</span></a></a><span> </span><a name="local-6989586621679086500"><a href="#local-6989586621679086500"><span class="hs-identifier">screenSizeY</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">get</span><span> </span><span class="hs-identifier hs-var">screenSize</span><span>
</span><a name="line-80"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679086501"><a href="#local-6989586621679086501"><span class="hs-identifier">initialPos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Position</span><span>
</span><a name="line-81"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679086499"><span class="hs-identifier hs-var">screenSizeX</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679085575"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679086500"><span class="hs-identifier hs-var">screenSizeY</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679085576"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>        </span><span class="hs-identifier hs-var">initialWindowPosition</span><span> </span><span class="hs-operator hs-var">$=</span><span> </span><a href="#local-6989586621679086501"><span class="hs-identifier hs-var">initialPos</span></a><span>
</span><a name="line-84"></a><span>        </span><span class="hs-identifier hs-var">createWindow</span><span> </span><span class="hs-string">&quot;Evolverbetert v1.0&quot;</span><span>
</span><a name="line-85"></a><span>        </span><span class="hs-identifier hs-var">matrixMode</span><span> </span><span class="hs-operator hs-var">$=</span><span> </span><span class="hs-identifier hs-var">Projection</span><span>
</span><a name="line-86"></a><span>        </span><span class="hs-identifier hs-var">loadIdentity</span><span>
</span><a name="line-87"></a><span>        </span><span class="hs-identifier hs-var">ortho2D</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085575"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085574"><span class="hs-identifier hs-var">pixelsPerUnit</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>                </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085576"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085574"><span class="hs-identifier hs-var">pixelsPerUnit</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>        </span><span class="hs-identifier hs-var">displayCallback</span><span> </span><span class="hs-operator hs-var">$=</span><span> </span><a href="MyGraphics.html#showWorld"><span class="hs-identifier hs-var">showWorld</span></a><span> </span><a href="#local-6989586621679084849"><span class="hs-identifier hs-var">worldRef</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-comment">-- Where the magic happens... Recursive function that ends on P.maxTime</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">hPutStrLn</span><span> </span><a href="#local-6989586621679084850"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-string">&quot;Hello, World!&quot;</span><span>
</span><a name="line-94"></a><span>    </span><a href="Evolverbetert.html#mainLoop"><span class="hs-identifier hs-var">mainLoop</span></a><span> </span><a href="#local-6989586621679084849"><span class="hs-identifier hs-var">worldRef</span></a><span> </span><a href="#local-6989586621679084850"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">hPutStrLn</span><span> </span><a href="#local-6989586621679084850"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-string">&quot;Goodbye World!&quot;</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier hs-var">hClose</span><span> </span><a href="#local-6989586621679084850"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Recursive function that reads the IORef of the world, changes it with</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- 'newWorld' and writes to world back.</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- Also writes output if 'P.outputTime'</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- Might display graphical output using mainLoopEvent from &quot;MyGraphics&quot;</span><span>
</span><a name="line-102"></a><span class="hs-identifier">mainLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Handle</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parameters.html#Time"><span class="hs-identifier hs-type">P</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Time</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><a name="mainLoop"><a href="Evolverbetert.html#mainLoop"><span class="hs-identifier">mainLoop</span></a></a><span> </span><a name="local-6989586621679088100"><a href="#local-6989586621679088100"><span class="hs-identifier">worldRef</span></a></a><span> </span><a name="local-6989586621679088101"><a href="#local-6989586621679088101"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679088102"><a href="#local-6989586621679088102"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679088102"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parameters.html#maxTime"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">maxTime</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span class="hs-identifier">mainLoop</span><span> </span><a name="local-6989586621679088103"><a href="#local-6989586621679088103"><span class="hs-identifier">worldRef</span></a></a><span> </span><a name="local-6989586621679088104"><a href="#local-6989586621679088104"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679088105"><a href="#local-6989586621679088105"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-105"></a><span>    </span><a name="local-6989586621679088106"><a href="#local-6989586621679088106"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679088103"><span class="hs-identifier hs-var">worldRef</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="Parameters.html#outputTime"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">outputTime</span></a><span> </span><a href="#local-6989586621679088105"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-108"></a><span>            </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">hPutStrLn</span><span> </span><a href="#local-6989586621679088104"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Evolverbetert.html#outputString"><span class="hs-identifier hs-var">outputString</span></a><span> </span><a href="#local-6989586621679088106"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679088105"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">hFlush</span><span> </span><a href="#local-6989586621679088104"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>    </span><a name="local-6989586621679088107"><a href="#local-6989586621679088107"><span class="hs-identifier">std</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MyRandom.html#getMyStdGen"><span class="hs-identifier hs-var">getMyStdGen</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679088108"><a href="#local-6989586621679088108"><span class="hs-identifier">w'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679088109"><a href="#local-6989586621679088109"><span class="hs-identifier">std'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MyRandom.html#runRand"><span class="hs-identifier hs-var">runRand</span></a><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#newWorld"><span class="hs-identifier hs-var">newWorld</span></a><span> </span><a href="#local-6989586621679088106"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679088107"><span class="hs-identifier hs-var">std</span></a><span>
</span><a name="line-112"></a><span>    </span><a href="MyRandom.html#setMyStdGen"><span class="hs-identifier hs-var">setMyStdGen</span></a><span> </span><a href="#local-6989586621679088109"><span class="hs-identifier hs-var">std'</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier hs-var">writeIORef</span><span> </span><a href="#local-6989586621679088103"><span class="hs-identifier hs-var">worldRef</span></a><span> </span><a href="#local-6989586621679088108"><span class="hs-identifier hs-var">w'</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><a href="Parameters.html#display"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">display</span></a><span> </span><span class="hs-operator hs-var">$</span><span>    </span><span class="hs-identifier hs-var">mainLoopEvent</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">postRedisplay</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span>    </span><a href="Evolverbetert.html#mainLoop"><span class="hs-identifier hs-var">mainLoop</span></a><span> </span><a href="#local-6989586621679088103"><span class="hs-identifier hs-var">worldRef</span></a><span> </span><a href="#local-6989586621679088104"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679088105"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- | Changes the Environment dependent on 'P.nrEnv' It works like a clock</span><span>
</span><a name="line-121"></a><span class="hs-identifier">chEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="World.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MyRandom.html#Rand"><span class="hs-identifier hs-type">Rand</span></a><span> </span><a href="World.html#Env"><span class="hs-identifier hs-type">Env</span></a><span>
</span><a name="line-122"></a><a name="chEnv"><a href="Evolverbetert.html#chEnv"><span class="hs-identifier">chEnv</span></a></a><span> </span><a name="local-6989586621679088200"><a href="#local-6989586621679088200"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-123"></a><span>    </span><a name="local-6989586621679088201"><a href="#local-6989586621679088201"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MyRandom.html#getRange"><span class="hs-identifier hs-var">getRange</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-number">1</span><span> </span><a href="Parameters.html#nrEnv"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">nrEnv</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679088200"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679088201"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod'</span><span class="hs-special">`</span><span> </span><a href="Parameters.html#nrEnv"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">nrEnv</span></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- Very ugly deepseq</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- henk :: World -&gt; IO ()</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- henk w = do</span><span>
</span><a name="line-129"></a><span class="hs-comment">--     h &lt;- newIORef $ Agent [[]] Map.empty</span><span>
</span><a name="line-130"></a><span class="hs-comment">--     writeIORef h $ maximumBy (compare `on` (`fitnessAgent` env w)) $ elems (agents w)</span><span>
</span><a name="line-131"></a><span class="hs-comment">--     readIORef h</span><span>
</span><a name="line-132"></a><span class="hs-comment">--     return ()</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- {-# NOINLINE henk #-}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Changes the environment dependent on 'P.envSwitchProb' with 'chEnv'</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- Makes new agents with 'newAssoc'</span><span>
</span><a name="line-137"></a><span class="hs-identifier">newWorld</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MyRandom.html#Rand"><span class="hs-identifier hs-type">Rand</span></a><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span>
</span><a name="line-138"></a><a name="newWorld"><a href="Evolverbetert.html#newWorld"><span class="hs-identifier">newWorld</span></a></a><span> </span><a name="local-6989586621679088202"><a href="#local-6989586621679088202"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-6989586621679088205"><a href="#local-6989586621679088205"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Misc.html#maybeCh"><span class="hs-identifier hs-var">maybeCh</span></a><span> </span><a href="#local-6989586621679088204"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="Evolverbetert.html#chEnv"><span class="hs-identifier hs-var">chEnv</span></a><span> </span><a href="Parameters.html#envSwitchProb"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">envSwitchProb</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span>    </span><a name="local-6989586621679088206"><a href="#local-6989586621679088206"><span class="hs-identifier">newAssocs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#newAssoc"><span class="hs-identifier hs-var">newAssoc</span></a><span> </span><a href="#local-6989586621679088202"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679088203"><span class="hs-identifier hs-var">oldAssocs</span></a><span> </span><span class="hs-comment">-- makes new association list</span><span>
</span><a name="line-142"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679088207"><a href="#local-6989586621679088207"><span class="hs-identifier">ags'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">array</span><span> </span><a href="Parameters.html#worldBounds"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">worldBounds</span></a><span> </span><a href="#local-6989586621679088206"><span class="hs-identifier hs-var">newAssocs</span></a><span>
</span><a name="line-143"></a><span>        </span><a name="local-6989586621679088208"><a href="#local-6989586621679088208"><span class="hs-identifier">w'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">agents</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679088207"><span class="hs-identifier hs-var">ags'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">env</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679088205"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">}</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679088208"><span class="hs-identifier hs-var">w'</span></a><span>
</span><a name="line-145"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679088203"><a href="#local-6989586621679088203"><span class="hs-identifier">oldAssocs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">assocs</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">agents</span><span> </span><a href="#local-6989586621679088202"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-146"></a><span>              </span><a name="local-6989586621679088204"><a href="#local-6989586621679088204"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">env</span><span> </span><a href="#local-6989586621679088202"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | The string of data that outputs every 'P.outputStep'</span><span>
</span><a name="line-149"></a><span class="hs-identifier">outputString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parameters.html#Time"><span class="hs-identifier hs-type">P</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Time</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-150"></a><a name="outputString"><a href="Evolverbetert.html#outputString"><span class="hs-identifier">outputString</span></a></a><span> </span><a name="local-6989586621679088209"><a href="#local-6989586621679088209"><span class="hs-identifier">w</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="World.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-6989586621679088210"><a href="#local-6989586621679088210"><span class="hs-identifier">ags</span></a></a><span> </span><a name="local-6989586621679088211"><a href="#local-6989586621679088211"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679088212"><a href="#local-6989586621679088212"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679088212"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679088211"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-comment">-- current environment</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="World.html#hammDistAg"><span class="hs-identifier hs-var">hammDistAg</span></a><span> </span><a href="#local-6989586621679088213"><span class="hs-identifier hs-var">bestAgent</span></a><span> </span><a href="#local-6989586621679088211"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Hamming distance of best agent</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679088214"><span class="hs-identifier hs-var">bestChrom</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The length of the genome of best</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679088214"><span class="hs-identifier hs-var">bestChrom</span></a><span>
</span><a name="line-156"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-157"></a><span>        </span><a name="local-6989586621679088213"><a href="#local-6989586621679088213"><span class="hs-identifier">bestAgent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maximumBy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="World.html#fitnessAgent"><span class="hs-identifier hs-var">fitnessAgent</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679088211"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679088210"><span class="hs-identifier hs-var">ags</span></a><span>
</span><a name="line-158"></a><span>        </span><a name="local-6989586621679088214"><a href="#local-6989586621679088214"><span class="hs-identifier">bestChrom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">genome</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679088213"><span class="hs-identifier hs-var">bestAgent</span></a><span>
</span><a name="line-159"></a><span>        </span><a name="local-6989586621679088215"><a href="#local-6989586621679088215"><span class="hs-identifier">maxFitness</span></a></a><span> </span><span class="hs-special">(</span><a href="World.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-6989586621679088217"><a href="#local-6989586621679088217"><span class="hs-identifier">ags</span></a></a><span> </span><a name="local-6989586621679088218"><a href="#local-6989586621679088218"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="World.html#fitnessAgent"><span class="hs-identifier hs-var">fitnessAgent</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679088218"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679088217"><span class="hs-identifier hs-var">ags</span></a><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>        </span><a name="local-6989586621679088216"><a href="#local-6989586621679088216"><span class="hs-identifier">minHammDist</span></a></a><span> </span><span class="hs-special">(</span><a href="World.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-6989586621679088219"><a href="#local-6989586621679088219"><span class="hs-identifier">ags</span></a></a><span> </span><a name="local-6989586621679088220"><a href="#local-6989586621679088220"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minimum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="World.html#hammDistAg"><span class="hs-identifier hs-var">hammDistAg</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679088220"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679088219"><span class="hs-identifier hs-var">ags</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | uses 'reproduceAgent' to make a new coordinate-Agent association</span><span>
</span><a name="line-164"></a><span class="hs-identifier">newAssoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="World.html#Agent"><span class="hs-identifier hs-type">Agent</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MyRandom.html#Rand"><span class="hs-identifier hs-type">Rand</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="World.html#Agent"><span class="hs-identifier hs-type">Agent</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><a name="newAssoc"><a href="Evolverbetert.html#newAssoc"><span class="hs-identifier">newAssoc</span></a></a><span> </span><a name="local-6989586621679088221"><a href="#local-6989586621679088221"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679088222"><a href="#local-6989586621679088222"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679088223"><a href="#local-6989586621679088223"><span class="hs-identifier">ag</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-166"></a><span>    </span><a name="local-6989586621679088224"><a href="#local-6989586621679088224"><span class="hs-identifier">ag'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Evolverbetert.html#reproduceAgent"><span class="hs-identifier hs-var">reproduceAgent</span></a><span> </span><a href="#local-6989586621679088221"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679088222"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-167"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679088222"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679088224"><span class="hs-identifier hs-var">ag'</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">-- | The NSF</span><span>
</span><a name="line-170"></a><span class="hs-identifier">reproduceAgent</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="World.html#World"><span class="hs-identifier hs-type">World</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MyRandom.html#Rand"><span class="hs-identifier hs-type">Rand</span></a><span> </span><a href="World.html#Agent"><span class="hs-identifier hs-type">Agent</span></a><span>
</span><a name="line-171"></a><a name="reproduceAgent"><a href="Evolverbetert.html#reproduceAgent"><span class="hs-identifier">reproduceAgent</span></a></a><span> </span><span class="hs-special">(</span><a href="World.html#World"><span class="hs-identifier hs-var">World</span></a><span> </span><a name="local-6989586621679088225"><a href="#local-6989586621679088225"><span class="hs-identifier">ags</span></a></a><span> </span><a name="local-6989586621679088226"><a href="#local-6989586621679088226"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679088227"><a href="#local-6989586621679088227"><span class="hs-identifier">ix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-172"></a><span>    </span><a name="local-6989586621679088228"><a href="#local-6989586621679088228"><span class="hs-identifier">temp1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MyRandom.html#getDouble"><span class="hs-identifier hs-var">getDouble</span></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679088228"><span class="hs-identifier hs-var">temp1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Parameters.html#deathRate"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">deathRate</span></a><span> </span><span class="hs-comment">--if you survive</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-keyword">then</span><span>
</span><a name="line-175"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679088225"><span class="hs-identifier hs-var">ags</span></a><span> </span><span class="hs-glyph">!</span><span> </span><a href="#local-6989586621679088227"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="World.html#NoAgent"><span class="hs-identifier hs-var">NoAgent</span></a><span> </span><span class="hs-comment">--if cell is empty, give every neighbour a weighted probability for getting chosen to reproduce</span><span>
</span><a name="line-176"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-177"></a><span>            </span><a name="local-6989586621679088229"><a href="#local-6989586621679088229"><span class="hs-identifier">temp2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MyRandom.html#getDouble"><span class="hs-identifier hs-var">getDouble</span></a><span>
</span><a name="line-178"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679088230"><a href="#local-6989586621679088230"><span class="hs-identifier">iChooseYou</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;=</span><a href="#local-6989586621679088235"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679088234"><span class="hs-identifier hs-var">cumFitAg</span></a><span>
</span><a name="line-179"></a><span>                </span><a name="local-6989586621679088231"><a href="#local-6989586621679088231"><span class="hs-identifier">neighbours</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679088225"><span class="hs-identifier hs-var">ags</span></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Misc.html#moore8"><span class="hs-identifier hs-var">moore8</span></a><span> </span><a href="#local-6989586621679088227"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="World.html#NoAgent"><span class="hs-identifier hs-var">NoAgent</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">--list of the neighbours</span><span>
</span><a name="line-180"></a><span>                </span><a name="local-6989586621679088232"><a href="#local-6989586621679088232"><span class="hs-identifier">fitnesses</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="World.html#fitnessAgent"><span class="hs-identifier hs-var">fitnessAgent</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679088226"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span> </span><a href="#local-6989586621679088231"><span class="hs-identifier hs-var">neighbours</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>                            </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-number">0.4</span><span class="hs-operator hs-var">^</span><a href="Parameters.html#selectionPressure"><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">selectionPressure</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">--list of fitnesses</span><span>
</span><a name="line-182"></a><span>                </span><a name="local-6989586621679088233"><a href="#local-6989586621679088233"><span class="hs-identifier">cumFitnesses</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">scanl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679088232"><span class="hs-identifier hs-var">fitnesses</span></a><span> </span><span class="hs-comment">--cumulative list of fitnesses</span><span>
</span><a name="line-183"></a><span>                </span><a name="local-6989586621679088234"><a href="#local-6989586621679088234"><span class="hs-identifier">cumFitAg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679088233"><span class="hs-identifier hs-var">cumFitnesses</span></a><span> </span><a href="#local-6989586621679088231"><span class="hs-identifier hs-var">neighbours</span></a><span> </span><span class="hs-comment">--list of (cumfit, agent) pairs</span><span>
</span><a name="line-184"></a><span>                </span><a name="local-6989586621679088235"><a href="#local-6989586621679088235"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679088229"><span class="hs-identifier hs-var">temp2</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><a href="#local-6989586621679088232"><span class="hs-identifier hs-var">fitnesses</span></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span>            </span><a name="local-6989586621679088236"><a href="#local-6989586621679088236"><span class="hs-identifier">iMutU</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Mutations.html#mutAg"><span class="hs-identifier hs-var">mutAg</span></a><span> </span><a href="#local-6989586621679088230"><span class="hs-identifier hs-var">iChooseYou</span></a><span>
</span><a name="line-187"></a><span>            </span><span class="hs-keyword">if</span><span>    </span><a href="#local-6989586621679088236"><span class="hs-identifier hs-var">iMutU</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679088230"><span class="hs-identifier hs-var">iChooseYou</span></a><span>
</span><a name="line-188"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="World.html#devAg"><span class="hs-identifier hs-var">devAg</span></a><span> </span><a href="#local-6989586621679088236"><span class="hs-identifier hs-var">iMutU</span></a><span>
</span><a name="line-189"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679088236"><span class="hs-identifier hs-var">iMutU</span></a><span>
</span><a name="line-190"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679088225"><span class="hs-identifier hs-var">ags</span></a><span class="hs-glyph">!</span><a href="#local-6989586621679088227"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="World.html#NoAgent"><span class="hs-identifier hs-var">NoAgent</span></a><span> </span><span class="hs-comment">-- if you die</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-identifier">options</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">OptDescr</span><span> </span><a href="Evolverbetert.html#Flag"><span class="hs-identifier hs-type">Flag</span></a><span class="hs-special">]</span><span>
</span><a name="line-194"></a><a name="options"><a href="Evolverbetert.html#options"><span class="hs-identifier">options</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span class="hs-char">'h'</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;help&quot;</span><span class="hs-special">]</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoArg</span><span> </span><a href="Evolverbetert.html#Help"><span class="hs-identifier hs-var">Help</span></a><span class="hs-special">)</span><span>                   </span><span class="hs-string">&quot;display this help info&quot;</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span class="hs-char">'w'</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;world-seed&quot;</span><span class="hs-special">]</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ReqArg</span><span> </span><a href="Evolverbetert.html#WorldSeed"><span class="hs-identifier hs-var">WorldSeed</span></a><span> </span><span class="hs-string">&quot;INT&quot;</span><span class="hs-special">)</span><span>       </span><span class="hs-string">&quot;give the seed for the world RNG (default: 420)&quot;</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;agent-seed&quot;</span><span class="hs-special">]</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ReqArg</span><span> </span><a href="Evolverbetert.html#AgentSeed"><span class="hs-identifier hs-var">AgentSeed</span></a><span> </span><span class="hs-string">&quot;INT&quot;</span><span class="hs-special">)</span><span>       </span><span class="hs-string">&quot;give the seed for the first agent RNG (default: 420)&quot;</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span class="hs-char">'o'</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;output-file&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ReqArg</span><span> </span><a href="Evolverbetert.html#OutputFile"><span class="hs-identifier hs-var">OutputFile</span></a><span> </span><span class="hs-string">&quot;FILEPATH&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;output file&quot;</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span class="hs-char">'g'</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;graphics&quot;</span><span class="hs-special">]</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoArg</span><span> </span><a href="Evolverbetert.html#Graphics"><span class="hs-identifier hs-var">Graphics</span></a><span class="hs-special">)</span><span>               </span><span class="hs-string">&quot;display CA in a window (Not yet working! Change the parameter file)&quot;</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-identifier">compilerOpts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Evolverbetert.html#Flag"><span class="hs-identifier hs-type">Flag</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><a name="compilerOpts"><a href="Evolverbetert.html#compilerOpts"><span class="hs-identifier">compilerOpts</span></a></a><span> </span><a name="local-6989586621679088237"><a href="#local-6989586621679088237"><span class="hs-identifier">argv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">getOpt</span><span> </span><span class="hs-identifier hs-var">Permute</span><span> </span><a href="Evolverbetert.html#options"><span class="hs-identifier hs-var">options</span></a><span> </span><a href="#local-6989586621679088237"><span class="hs-identifier hs-var">argv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679088239"><a href="#local-6989586621679088239"><span class="hs-identifier">o</span></a></a><span class="hs-special">,</span><a name="local-6989586621679088240"><a href="#local-6989586621679088240"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679088239"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">,</span><a href="#local-6989586621679088240"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679088241"><a href="#local-6989586621679088241"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">ioError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">userError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679088241"><span class="hs-identifier hs-var">errs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">usageInfo</span><span> </span><a href="#local-6989586621679088238"><span class="hs-identifier hs-var">header</span></a><span> </span><a href="Evolverbetert.html#options"><span class="hs-identifier hs-var">options</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679088238"><a href="#local-6989586621679088238"><span class="hs-identifier">header</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Usage: Evolverbetert [OPTION...] files...&quot;</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-keyword">data</span><span> </span><a name="Flag"><a href="Evolverbetert.html#Flag"><span class="hs-identifier">Flag</span></a></a><span>
</span><a name="line-209"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Help"><a href="Evolverbetert.html#Help"><span class="hs-identifier">Help</span></a></a><span>
</span><a name="line-210"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="OutputFile"><a href="Evolverbetert.html#OutputFile"><span class="hs-identifier">OutputFile</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="WorldSeed"><a href="Evolverbetert.html#WorldSeed"><span class="hs-identifier">WorldSeed</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="AgentSeed"><a href="Evolverbetert.html#AgentSeed"><span class="hs-identifier">AgentSeed</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Graphics"><a href="Evolverbetert.html#Graphics"><span class="hs-identifier">Graphics</span></a></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><a name="isHelp"><a href="Evolverbetert.html#isHelp"><span class="hs-identifier">isHelp</span></a></a><span>        </span><a href="Evolverbetert.html#Help"><span class="hs-identifier hs-var">Help</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">isHelp</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-216"></a><a name="isOutputFile"><a href="Evolverbetert.html#isOutputFile"><span class="hs-identifier">isOutputFile</span></a></a><span> </span><span class="hs-special">(</span><a href="Evolverbetert.html#OutputFile"><span class="hs-identifier hs-var">OutputFile</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">isOutputFile</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-217"></a><a name="isWorldSeed"><a href="Evolverbetert.html#isWorldSeed"><span class="hs-identifier">isWorldSeed</span></a></a><span>  </span><span class="hs-special">(</span><a href="Evolverbetert.html#WorldSeed"><span class="hs-identifier hs-var">WorldSeed</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">isWorldSeed</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-218"></a><a name="isAgentSeed"><a href="Evolverbetert.html#isAgentSeed"><span class="hs-identifier">isAgentSeed</span></a></a><span>  </span><span class="hs-special">(</span><a href="Evolverbetert.html#AgentSeed"><span class="hs-identifier hs-var">AgentSeed</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">isAgentSeed</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-219"></a><a name="isGraphics"><a href="Evolverbetert.html#isGraphics"><span class="hs-identifier">isGraphics</span></a></a><span>    </span><a href="Evolverbetert.html#Graphics"><span class="hs-identifier hs-var">Graphics</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">isGraphics</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-220"></a></pre></body></html>